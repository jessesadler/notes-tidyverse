<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.537">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2023-03-31">
<title>tidyverse notes - 10&nbsp; tidyr: Pivoting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01-tidyr-rectangling.html" rel="next">
<link href="./01-tidy-data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-pipe.html">tidyverse</a></li><li class="breadcrumb-item"><a href="./01-tidyr-pivoting.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">tidyr: Pivoting</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">tidyverse notes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jessesadler/notes-tidyverse" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-pipe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Pipe: magrittr and native</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-readr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">readr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-dplyr-colwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">dplyr: Column-wise operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-dplyr-rowwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">dplyr: Row-wise operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-dplyr-1.0.0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">dplyr 1.0.0</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-dplyr-1.1.0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">dplyr 1.1.0</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-forcats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">forcats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-lubridate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dates and times with lubridate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-tidy-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tidy data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-tidyr-pivoting.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">tidyr: Pivoting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-tidyr-rectangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">tidyr: Rectandling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">purrr</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">ggplot2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ggplot2-rstudioconf-2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">RStudio conf 2022 ggplot2 workshop</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-geoms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Geoms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-annotations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Annotations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-aesthetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Aesthetics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-scales-position.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Position scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-scales-color.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Color scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-scales-aes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Aesthetic scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-coords.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Coordinates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-guides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Guides: Legends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-facets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Facets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-themes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Themes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">patchwork</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">tidy eval</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-programming-dplyr-superceded.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Programming with dplyr (pre 1.0.0)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-programming-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Programming with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-metaprogramming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Advanced R: Metaprogramming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-rlang-tidyeval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">rlang: Tidy evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-rlang-metaprogramming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">rlang: Metaprogramming</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readr-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">readr example data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-longer" id="toc-sec-longer" class="nav-link active" data-scroll-target="#sec-longer"><span class="header-section-number">10.1</span> Longer</a>
  <ul class="collapse">
<li><a href="#sec-string-data" id="toc-sec-string-data" class="nav-link" data-scroll-target="#sec-string-data"><span class="header-section-number">10.1.1</span> String data in column names</a></li>
  <li><a href="#sec-num-data" id="toc-sec-num-data" class="nav-link" data-scroll-target="#sec-num-data"><span class="header-section-number">10.1.2</span> Numeric data in column names</a></li>
  <li><a href="#sec-multi-vars" id="toc-sec-multi-vars" class="nav-link" data-scroll-target="#sec-multi-vars"><span class="header-section-number">10.1.3</span> Many variables in column names</a></li>
  <li><a href="#sec-multi-obs" id="toc-sec-multi-obs" class="nav-link" data-scroll-target="#sec-multi-obs"><span class="header-section-number">10.1.4</span> Multiple observations per row</a></li>
  </ul>
</li>
  <li>
<a href="#sec-wider" id="toc-sec-wider" class="nav-link" data-scroll-target="#sec-wider"><span class="header-section-number">10.2</span> Wider</a>
  <ul class="collapse">
<li><a href="#sec-capture" id="toc-sec-capture" class="nav-link" data-scroll-target="#sec-capture"><span class="header-section-number">10.2.1</span> Capture-recapture data</a></li>
  <li><a href="#sec-agg" id="toc-sec-agg" class="nav-link" data-scroll-target="#sec-agg"><span class="header-section-number">10.2.2</span> Aggregation</a></li>
  <li><a href="#sec-create-colnames" id="toc-sec-create-colnames" class="nav-link" data-scroll-target="#sec-create-colnames"><span class="header-section-number">10.2.3</span> Generate column name from multiple variables</a></li>
  <li><a href="#sec-tidy-census" id="toc-sec-tidy-census" class="nav-link" data-scroll-target="#sec-tidy-census"><span class="header-section-number">10.2.4</span> Tidy census</a></li>
  <li><a href="#sec-missing-vals" id="toc-sec-missing-vals" class="nav-link" data-scroll-target="#sec-missing-vals"><span class="header-section-number">10.2.5</span> Implicit missing values</a></li>
  <li><a href="#sec-unused-cols" id="toc-sec-unused-cols" class="nav-link" data-scroll-target="#sec-unused-cols"><span class="header-section-number">10.2.6</span> Unused columns</a></li>
  <li><a href="#sec-contacts" id="toc-sec-contacts" class="nav-link" data-scroll-target="#sec-contacts"><span class="header-section-number">10.2.7</span> Contact list</a></li>
  </ul>
</li>
  <li>
<a href="#sec-longer-wider" id="toc-sec-longer-wider" class="nav-link" data-scroll-target="#sec-longer-wider"><span class="header-section-number">10.3</span> Longer, then wider</a>
  <ul class="collapse">
<li><a href="#sec-worldbank" id="toc-sec-worldbank" class="nav-link" data-scroll-target="#sec-worldbank"><span class="header-section-number">10.3.1</span> World bank</a></li>
  <li><a href="#sec-multi-choice" id="toc-sec-multi-choice" class="nav-link" data-scroll-target="#sec-multi-choice"><span class="header-section-number">10.3.2</span> Multi-choice</a></li>
  </ul>
</li>
  <li>
<a href="#sec-specs" id="toc-sec-specs" class="nav-link" data-scroll-target="#sec-specs"><span class="header-section-number">10.4</span> Manual specs</a>
  <ul class="collapse">
<li><a href="#sec-long-spec" id="toc-sec-long-spec" class="nav-link" data-scroll-target="#sec-long-spec"><span class="header-section-number">10.4.1</span> Longer</a></li>
  <li><a href="#sec-wide-spec" id="toc-sec-wide-spec" class="nav-link" data-scroll-target="#sec-wide-spec"><span class="header-section-number">10.4.2</span> Wider</a></li>
  <li><a href="#sec-by-hand" id="toc-sec-by-hand" class="nav-link" data-scroll-target="#sec-by-hand"><span class="header-section-number">10.4.3</span> By hand</a></li>
  <li><a href="#sec-theory" id="toc-sec-theory" class="nav-link" data-scroll-target="#sec-theory"><span class="header-section-number">10.4.4</span> Theory</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/jessesadler/notes-tidyverse/edit/main/01-tidyr-pivoting.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jessesadler/notes-tidyverse/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-pipe.html">tidyverse</a></li><li class="breadcrumb-item"><a href="./01-tidyr-pivoting.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">tidyr: Pivoting</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-pivoting" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">tidyr: Pivoting</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 31, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 8, 2024</p>
    </div>
  </div>
    
  </div>
  


</header><p><a href="https://tidyr.tidyverse.org/articles/pivot.html">This vignette</a> describes the usage of <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> as tidying methods that supersede <code><a href="https://tidyr.tidyverse.org/reference/gather.html">gather()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/spread.html">spread()</a></code>. The two new functions are meant to be more intuitive than <code><a href="https://tidyr.tidyverse.org/reference/gather.html">gather()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/spread.html">spread()</a></code>. They can work with multiple value variables that may have different types and can use specs to model the shape of the outcome.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-longer" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="sec-longer">
<span class="header-section-number">10.1</span> Longer</h2>
<p><code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> makes datasets <strong>longer</strong> by increasing the number of rows and decreasing the number of columns.</p>
<p><code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> arguments:</p>
<ul>
<li><code>data</code></li>
<li>
<code>cols</code>: Columns to pivot into longer format.</li>
<li>
<code>names_to</code>: The new column or columns to create from the information stored in the column names of <code>data</code> specified by <code>cols</code>.</li>
<li>
<code>values_to</code>: The name of the column to create from the data stored in cell values.</li>
<li>
<code>names_prefix</code>: A regular expression used to remove matching text from the start of each variable name.</li>
<li>
<code>names_transform</code>: Either a single function applied to all columns or a list of column name-function pairs.</li>
<li>
<code>names_sep</code>, <code>names_pattern</code>: Control how the column name is broken up when multiple names are passed to <code>names_to</code>.
<ul>
<li>
<code>names_sep</code>: Either a numeric vector of where to split or regular expression.</li>
<li>
<code>names_pattern</code>: A regular expression containing matching groups.</li>
</ul>
</li>
</ul>
<section id="sec-string-data" class="level3" data-number="10.1.1"><h3 data-number="10.1.1" class="anchored" data-anchor-id="sec-string-data">
<span class="header-section-number">10.1.1</span> String data in column names</h3>
<p>Data: <code>relig_income</code></p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relig_income</span></span>
<span><span class="co">#&gt; # A tibble: 18 × 11</span></span>
<span><span class="co">#&gt;    religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Agnostic      27        34        60        81        76       137        122</span></span>
<span><span class="co">#&gt;  2 Atheist       12        27        37        52        35        70         73</span></span>
<span><span class="co">#&gt;  3 Buddhist      27        21        30        34        33        58         62</span></span>
<span><span class="co">#&gt;  4 Catholic     418       617       732       670       638      1116        949</span></span>
<span><span class="co">#&gt;  5 Don’t k…      15        14        15        11        10        35         21</span></span>
<span><span class="co">#&gt;  6 Evangel…     575       869      1064       982       881      1486        949</span></span>
<span><span class="co">#&gt;  7 Hindu          1         9         7         9        11        34         47</span></span>
<span><span class="co">#&gt;  8 Histori…     228       244       236       238       197       223        131</span></span>
<span><span class="co">#&gt;  9 Jehovah…      20        27        24        24        21        30         15</span></span>
<span><span class="co">#&gt; 10 Jewish        19        19        25        25        30        95         69</span></span>
<span><span class="co">#&gt; 11 Mainlin…     289       495       619       655       651      1107        939</span></span>
<span><span class="co">#&gt; 12 Mormon        29        40        48        51        56       112         85</span></span>
<span><span class="co">#&gt; 13 Muslim         6         7         9        10         9        23         16</span></span>
<span><span class="co">#&gt; 14 Orthodox      13        17        23        32        32        47         38</span></span>
<span><span class="co">#&gt; 15 Other C…       9         7        11        13        13        14         18</span></span>
<span><span class="co">#&gt; 16 Other F…      20        33        40        46        49        63         46</span></span>
<span><span class="co">#&gt; 17 Other W…       5         2         3         4         2         7          3</span></span>
<span><span class="co">#&gt; 18 Unaffil…     217       299       374       365       341       528        407</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Don't know/refused` &lt;dbl&gt;</span></span>
<span></span>
<span><span class="co"># Pivot all columns except religion</span></span>
<span><span class="va">relig_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">!</span><span class="va">religion</span>, </span>
<span>    names_to <span class="op">=</span> <span class="st">"income"</span>, </span>
<span>    values_to <span class="op">=</span> <span class="st">"count"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 180 × 3</span></span>
<span><span class="co">#&gt;    religion income             count</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Agnostic &lt;$10k                 27</span></span>
<span><span class="co">#&gt;  2 Agnostic $10-20k               34</span></span>
<span><span class="co">#&gt;  3 Agnostic $20-30k               60</span></span>
<span><span class="co">#&gt;  4 Agnostic $30-40k               81</span></span>
<span><span class="co">#&gt;  5 Agnostic $40-50k               76</span></span>
<span><span class="co">#&gt;  6 Agnostic $50-75k              137</span></span>
<span><span class="co">#&gt;  7 Agnostic $75-100k             122</span></span>
<span><span class="co">#&gt;  8 Agnostic $100-150k            109</span></span>
<span><span class="co">#&gt;  9 Agnostic &gt;150k                 84</span></span>
<span><span class="co">#&gt; 10 Agnostic Don't know/refused    96</span></span>
<span><span class="co">#&gt; # ℹ 170 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-num-data" class="level3" data-number="10.1.2"><h3 data-number="10.1.2" class="anchored" data-anchor-id="sec-num-data">
<span class="header-section-number">10.1.2</span> Numeric data in column names</h3>
<p>Data: <code>billboard</code></p>
<p>Use of arguments <code>names_prefix</code> to strip away prefix in column names of <code>wk</code> and <code>names_transform</code> to convert character to integer.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">billboard</span></span>
<span><span class="co">#&gt; # A tibble: 317 × 79</span></span>
<span><span class="co">#&gt;    artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA</span></span>
<span><span class="co">#&gt;  2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA</span></span>
<span><span class="co">#&gt;  3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53</span></span>
<span><span class="co">#&gt;  4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59</span></span>
<span><span class="co">#&gt;  5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49</span></span>
<span><span class="co">#&gt;  6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2</span></span>
<span><span class="co">#&gt;  7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA</span></span>
<span><span class="co">#&gt;  8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38</span></span>
<span><span class="co">#&gt;  9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14</span></span>
<span><span class="co">#&gt; 10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58</span></span>
<span><span class="co">#&gt; # ℹ 307 more rows</span></span>
<span><span class="co">#&gt; # ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</span></span>
<span></span>
<span><span class="va">billboard</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"wk"</span><span class="op">)</span>, </span>
<span>    names_to <span class="op">=</span> <span class="st">"week"</span>, </span>
<span>    names_prefix <span class="op">=</span> <span class="st">"wk"</span>,</span>
<span>    names_transform <span class="op">=</span> <span class="va">as.integer</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"rank"</span>,</span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5,307 × 5</span></span>
<span><span class="co">#&gt;    artist  track                   date.entered  week  rank</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2 Pac   Baby Don't Cry (Keep... 2000-02-26       1    87</span></span>
<span><span class="co">#&gt;  2 2 Pac   Baby Don't Cry (Keep... 2000-02-26       2    82</span></span>
<span><span class="co">#&gt;  3 2 Pac   Baby Don't Cry (Keep... 2000-02-26       3    72</span></span>
<span><span class="co">#&gt;  4 2 Pac   Baby Don't Cry (Keep... 2000-02-26       4    77</span></span>
<span><span class="co">#&gt;  5 2 Pac   Baby Don't Cry (Keep... 2000-02-26       5    87</span></span>
<span><span class="co">#&gt;  6 2 Pac   Baby Don't Cry (Keep... 2000-02-26       6    94</span></span>
<span><span class="co">#&gt;  7 2 Pac   Baby Don't Cry (Keep... 2000-02-26       7    99</span></span>
<span><span class="co">#&gt;  8 2Ge+her The Hardest Part Of ... 2000-09-02       1    91</span></span>
<span><span class="co">#&gt;  9 2Ge+her The Hardest Part Of ... 2000-09-02       2    87</span></span>
<span><span class="co">#&gt; 10 2Ge+her The Hardest Part Of ... 2000-09-02       3    92</span></span>
<span><span class="co">#&gt; # ℹ 5,297 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-multi-vars" class="level3" data-number="10.1.3"><h3 data-number="10.1.3" class="anchored" data-anchor-id="sec-multi-vars">
<span class="header-section-number">10.1.3</span> Many variables in column names</h3>
<p>Data <code>who</code></p>
<p>columns from <code>new_sp_m014</code> to <code>newrel_f65</code> encode four variables in their names:</p>
<ul>
<li>The <code>new_</code>/<code>new</code> prefix indicates these are counts of new cases.</li>
<li>
<code>sp</code>/<code>rel</code>/<code>ep</code> describe how the case was diagnosed.</li>
<li>
<code>m</code>/<code>f</code> gives the gender.</li>
<li>
<code>014</code>/<code>1524</code>/<code>2535</code>/<code>3544</code>/<code>4554</code>/<code>65</code> supplies the age range.</li>
</ul>
<p>To deal with this:</p>
<ol type="1">
<li>Specifying multiple column names in <code>names_to</code>.</li>
<li>Separate column values with either <code>names_sep</code> or <code>names_pattern</code>.</li>
<li>Use of <code>readr</code> functions to convert the gender and age to factors. This is faster than using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> afterwards.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">who</span></span>
<span><span class="co">#&gt; # A tibble: 7,240 × 60</span></span>
<span><span class="co">#&gt;    country  iso2  iso3   year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Afghani… AF    AFG    1980          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  2 Afghani… AF    AFG    1981          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  3 Afghani… AF    AFG    1982          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  4 Afghani… AF    AFG    1983          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  5 Afghani… AF    AFG    1984          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  6 Afghani… AF    AFG    1985          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  7 Afghani… AF    AFG    1986          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  8 Afghani… AF    AFG    1987          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt;  9 Afghani… AF    AFG    1988          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt; 10 Afghani… AF    AFG    1989          NA           NA           NA           NA</span></span>
<span><span class="co">#&gt; # ℹ 7,230 more rows</span></span>
<span><span class="co">#&gt; # ℹ 52 more variables: new_sp_m4554 &lt;dbl&gt;, new_sp_m5564 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   new_sp_m65 &lt;dbl&gt;, new_sp_f014 &lt;dbl&gt;, new_sp_f1524 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   new_sp_f2534 &lt;dbl&gt;, new_sp_f3544 &lt;dbl&gt;, new_sp_f4554 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   new_sp_f5564 &lt;dbl&gt;, new_sp_f65 &lt;dbl&gt;, new_sn_m014 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   new_sn_m1524 &lt;dbl&gt;, new_sn_m2534 &lt;dbl&gt;, new_sn_m3544 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   new_sn_m4554 &lt;dbl&gt;, new_sn_m5564 &lt;dbl&gt;, new_sn_m65 &lt;dbl&gt;, …</span></span>
<span></span>
<span><span class="va">who</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="va">new_sp_m014</span><span class="op">:</span><span class="va">newrel_f65</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span><span class="op">)</span>, </span>
<span>    names_pattern <span class="op">=</span> <span class="st">"new_?(.*)_(.)(.*)"</span>,</span>
<span>    names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      gender <span class="op">=</span> <span class="op">~</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">parse_factor</a></span><span class="op">(</span><span class="va">.x</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"m"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      age <span class="op">=</span> <span class="op">~</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">parse_factor</a></span><span class="op">(</span></span>
<span>        <span class="va">.x</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"014"</span>, <span class="st">"1524"</span>, <span class="st">"2534"</span>, <span class="st">"3544"</span>, <span class="st">"4554"</span>, <span class="st">"5564"</span>, <span class="st">"65"</span><span class="op">)</span>, </span>
<span>        ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"count"</span>,</span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 405,440 × 8</span></span>
<span><span class="co">#&gt;    country     iso2  iso3   year diagnosis gender age   count</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;fct&gt;  &lt;ord&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Afghanistan AF    AFG    1980 sp        m      014      NA</span></span>
<span><span class="co">#&gt;  2 Afghanistan AF    AFG    1980 sp        m      1524     NA</span></span>
<span><span class="co">#&gt;  3 Afghanistan AF    AFG    1980 sp        m      2534     NA</span></span>
<span><span class="co">#&gt;  4 Afghanistan AF    AFG    1980 sp        m      3544     NA</span></span>
<span><span class="co">#&gt;  5 Afghanistan AF    AFG    1980 sp        m      4554     NA</span></span>
<span><span class="co">#&gt;  6 Afghanistan AF    AFG    1980 sp        m      5564     NA</span></span>
<span><span class="co">#&gt;  7 Afghanistan AF    AFG    1980 sp        m      65       NA</span></span>
<span><span class="co">#&gt;  8 Afghanistan AF    AFG    1980 sp        f      014      NA</span></span>
<span><span class="co">#&gt;  9 Afghanistan AF    AFG    1980 sp        f      1524     NA</span></span>
<span><span class="co">#&gt; 10 Afghanistan AF    AFG    1980 sp        f      2534     NA</span></span>
<span><span class="co">#&gt; # ℹ 405,430 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-multi-obs" class="level3" data-number="10.1.4"><h3 data-number="10.1.4" class="anchored" data-anchor-id="sec-multi-obs">
<span class="header-section-number">10.1.4</span> Multiple observations per row</h3>
<p>Data: <code>household</code></p>
<p>Use of <code>".value"</code> in <code>names_to</code> to indicate that part of the column name specifies the “value” being measured and so should be used as a variable name.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">household</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 5</span></span>
<span><span class="co">#&gt;   family dob_child1 dob_child2 name_child1 name_child2</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1      1 1998-11-26 2000-01-29 Susan       Jose       </span></span>
<span><span class="co">#&gt; 2      2 1996-06-22 NA         Mark        &lt;NA&gt;       </span></span>
<span><span class="co">#&gt; 3      3 2002-07-11 2004-04-05 Sam         Seth       </span></span>
<span><span class="co">#&gt; 4      4 2004-10-10 2009-08-27 Craig       Khai       </span></span>
<span><span class="co">#&gt; 5      5 2000-12-05 2005-02-28 Parker      Gracie</span></span>
<span></span>
<span><span class="va">household</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">!</span><span class="va">family</span>, </span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"child"</span><span class="op">)</span>, </span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span>, </span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 4</span></span>
<span><span class="co">#&gt;   family child  dob        name  </span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1      1 child1 1998-11-26 Susan </span></span>
<span><span class="co">#&gt; 2      1 child2 2000-01-29 Jose  </span></span>
<span><span class="co">#&gt; 3      2 child1 1996-06-22 Mark  </span></span>
<span><span class="co">#&gt; 4      3 child1 2002-07-11 Sam   </span></span>
<span><span class="co">#&gt; 5      3 child2 2004-04-05 Seth  </span></span>
<span><span class="co">#&gt; 6      4 child1 2004-10-10 Craig </span></span>
<span><span class="co">#&gt; 7      4 child2 2009-08-27 Khai  </span></span>
<span><span class="co">#&gt; 8      5 child1 2000-12-05 Parker</span></span>
<span><span class="co">#&gt; 9      5 child2 2005-02-28 Gracie</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Data: <code>anscombe</code></p>
<p>Use of <code>cols_vary = "slowest"</code> to group values from columns <code>x1</code> and <code>y1</code> together,.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">anscombe</span></span>
<span><span class="co">#&gt;    x1 x2 x3 x4    y1   y2    y3    y4</span></span>
<span><span class="co">#&gt; 1  10 10 10  8  8.04 9.14  7.46  6.58</span></span>
<span><span class="co">#&gt; 2   8  8  8  8  6.95 8.14  6.77  5.76</span></span>
<span><span class="co">#&gt; 3  13 13 13  8  7.58 8.74 12.74  7.71</span></span>
<span><span class="co">#&gt; 4   9  9  9  8  8.81 8.77  7.11  8.84</span></span>
<span><span class="co">#&gt; 5  11 11 11  8  8.33 9.26  7.81  8.47</span></span>
<span><span class="co">#&gt; 6  14 14 14  8  9.96 8.10  8.84  7.04</span></span>
<span><span class="co">#&gt; 7   6  6  6  8  7.24 6.13  6.08  5.25</span></span>
<span><span class="co">#&gt; 8   4  4  4 19  4.26 3.10  5.39 12.50</span></span>
<span><span class="co">#&gt; 9  12 12 12  8 10.84 9.13  8.15  5.56</span></span>
<span><span class="co">#&gt; 10  7  7  7  8  4.82 7.26  6.42  7.91</span></span>
<span><span class="co">#&gt; 11  5  5  5  8  5.68 4.74  5.73  6.89</span></span>
<span></span>
<span><span class="va">anscombe</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>    cols_vary <span class="op">=</span> <span class="st">"slowest"</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"set"</span><span class="op">)</span>, </span>
<span>    names_pattern <span class="op">=</span> <span class="st">"(.)(.)"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 44 × 3</span></span>
<span><span class="co">#&gt;    set       x     y</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 1        10  8.04</span></span>
<span><span class="co">#&gt;  2 1         8  6.95</span></span>
<span><span class="co">#&gt;  3 1        13  7.58</span></span>
<span><span class="co">#&gt;  4 1         9  8.81</span></span>
<span><span class="co">#&gt;  5 1        11  8.33</span></span>
<span><span class="co">#&gt;  6 1        14  9.96</span></span>
<span><span class="co">#&gt;  7 1         6  7.24</span></span>
<span><span class="co">#&gt;  8 1         4  4.26</span></span>
<span><span class="co">#&gt;  9 1        12 10.8 </span></span>
<span><span class="co">#&gt; 10 1         7  4.82</span></span>
<span><span class="co">#&gt; # ℹ 34 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-wider" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="sec-wider">
<span class="header-section-number">10.2</span> Wider</h2>
<p><code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> makes a dataset <strong>wider</strong> by increasing the number of columns and decreasing the number of rows.</p>
<p><code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> arguments:</p>
<ul>
<li><code>data</code></li>
<li>
<code>names_from</code>: Column used to create column names.</li>
<li>
<code>values_from</code>: Column used to create cell values.</li>
<li>
<code>values_fill</code>: Default value instead of <code>NA</code>.</li>
<li>
<code>values_fn</code>: A function applied to the value in each cell in the output.
<ul>
<li>You will typically use this when the combination of <code>id_cols</code> and <code>names_from</code> columns does not uniquely identify an observation.</li>
</ul>
</li>
<li>
<code>names_prefix</code>: String added to the start of every variable name.</li>
<li>
<code>names_sep</code>: If <code>names_from</code> or <code>values_from</code> contains multiple variables, this will be used to join their values together into a single string to use as a column name.</li>
<li>
<code>names_glue</code>: Instead of <code>names_sep</code> and <code>names_prefix</code>, you can supply a glue specification that uses the <code>names_from</code> columns (and special <code>.value</code>) to create custom column names.</li>
<li>
<code>names_expand</code>: Whether to make implicit factor levels explicit.</li>
<li>
<code>id_cols</code>: A set of columns that uniquely identify each observation.</li>
<li>
<code>id_expand</code>: Whether to make implicit factor levels explicit in <code>id_cols</code>.</li>
<li>
<code>unused_fn</code>: A function applied to summarize the values from the unused columns (i.e.&nbsp;columns not identified by <code>id_cols</code>, <code>names_from</code>, or <code>values_from</code>).</li>
</ul>
<section id="sec-capture" class="level3" data-number="10.2.1"><h3 data-number="10.2.1" class="anchored" data-anchor-id="sec-capture">
<span class="header-section-number">10.2.1</span> Capture-recapture data</h3>
<p>Data: <code>fish_encounters</code></p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fish_encounters</span></span>
<span><span class="co">#&gt; # A tibble: 114 × 3</span></span>
<span><span class="co">#&gt;    fish  station  seen</span></span>
<span><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 4842  Release     1</span></span>
<span><span class="co">#&gt;  2 4842  I80_1       1</span></span>
<span><span class="co">#&gt;  3 4842  Lisbon      1</span></span>
<span><span class="co">#&gt;  4 4842  Rstr        1</span></span>
<span><span class="co">#&gt;  5 4842  Base_TD     1</span></span>
<span><span class="co">#&gt;  6 4842  BCE         1</span></span>
<span><span class="co">#&gt;  7 4842  BCW         1</span></span>
<span><span class="co">#&gt;  8 4842  BCE2        1</span></span>
<span><span class="co">#&gt;  9 4842  BCW2        1</span></span>
<span><span class="co">#&gt; 10 4842  MAE         1</span></span>
<span><span class="co">#&gt; # ℹ 104 more rows</span></span>
<span></span>
<span><span class="va">fish_encounters</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">station</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">seen</span>,</span>
<span>    values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 19 × 12</span></span>
<span><span class="co">#&gt;    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 4842        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt;  2 4843        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt;  3 4844        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt;  4 4845        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  5 4847        1     1      1     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  6 4848        1     1      1     1       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  7 4849        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  8 4850        1     1      0     1       1     1     1     0     0     0     0</span></span>
<span><span class="co">#&gt;  9 4851        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 10 4854        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 11 4855        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 12 4857        1     1      1     1       1     1     1     1     1     0     0</span></span>
<span><span class="co">#&gt; 13 4858        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; 14 4859        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 15 4861        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; 16 4862        1     1      1     1       1     1     1     1     1     0     0</span></span>
<span><span class="co">#&gt; 17 4863        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 18 4864        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 19 4865        1     1      1     0       0     0     0     0     0     0     0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-agg" class="level3" data-number="10.2.2"><h3 data-number="10.2.2" class="anchored" data-anchor-id="sec-agg">
<span class="header-section-number">10.2.2</span> Aggregation</h3>
<p>Data: <code>warpbreaks</code></p>
<p>Use of <code>values_fn</code> to create aggregate when <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> matches multiple cells.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">warpbreaks</span> <span class="op">&lt;-</span> <span class="va">warpbreaks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">wool</span>, <span class="va">tension</span>, <span class="va">breaks</span><span class="op">)</span></span>
<span><span class="va">warpbreaks</span></span>
<span><span class="co">#&gt; # A tibble: 54 × 3</span></span>
<span><span class="co">#&gt;    wool  tension breaks</span></span>
<span><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 A     L           26</span></span>
<span><span class="co">#&gt;  2 A     L           30</span></span>
<span><span class="co">#&gt;  3 A     L           54</span></span>
<span><span class="co">#&gt;  4 A     L           25</span></span>
<span><span class="co">#&gt;  5 A     L           70</span></span>
<span><span class="co">#&gt;  6 A     L           52</span></span>
<span><span class="co">#&gt;  7 A     L           51</span></span>
<span><span class="co">#&gt;  8 A     L           26</span></span>
<span><span class="co">#&gt;  9 A     L           67</span></span>
<span><span class="co">#&gt; 10 A     M           18</span></span>
<span><span class="co">#&gt; # ℹ 44 more rows</span></span>
<span></span>
<span><span class="co"># Multiple matches creates list columns</span></span>
<span><span class="va">warpbreaks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">wool</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">breaks</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Values from `breaks` are not uniquely identified; output will contain</span></span>
<span><span class="co">#&gt; list-cols.</span></span>
<span><span class="co">#&gt; • Use `values_fn = list` to suppress this warning.</span></span>
<span><span class="co">#&gt; • Use `values_fn = {summary_fun}` to summarise duplicates.</span></span>
<span><span class="co">#&gt; • Use the following dplyr code to identify duplicates.</span></span>
<span><span class="co">#&gt;   {data} %&gt;%</span></span>
<span><span class="co">#&gt;   dplyr::group_by(tension, wool) %&gt;%</span></span>
<span><span class="co">#&gt;   dplyr::summarise(n = dplyr::n(), .groups = "drop") %&gt;%</span></span>
<span><span class="co">#&gt;   dplyr::filter(n &gt; 1L)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   tension A         B        </span></span>
<span><span class="co">#&gt;   &lt;fct&gt;   &lt;list&gt;    &lt;list&gt;   </span></span>
<span><span class="co">#&gt; 1 L       &lt;dbl [9]&gt; &lt;dbl [9]&gt;</span></span>
<span><span class="co">#&gt; 2 M       &lt;dbl [9]&gt; &lt;dbl [9]&gt;</span></span>
<span><span class="co">#&gt; 3 H       &lt;dbl [9]&gt; &lt;dbl [9]&gt;</span></span>
<span></span>
<span><span class="co"># values_fn to summarise values</span></span>
<span><span class="va">warpbreaks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">wool</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>    values_fn <span class="op">=</span> <span class="va">mean</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   tension     A     B</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 L        44.6  28.2</span></span>
<span><span class="co">#&gt; 2 M        24    28.8</span></span>
<span><span class="co">#&gt; 3 H        24.6  18.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-create-colnames" class="level3" data-number="10.2.3"><h3 data-number="10.2.3" class="anchored" data-anchor-id="sec-create-colnames">
<span class="header-section-number">10.2.3</span> Generate column name from multiple variables</h3>
<p>Data: <code>production</code></p>
<p>Take tidy data and widen to have one column for each combination of two columns. Do this by specifying multiple variables for <code>names_from</code>.</p>
<p>Control how the column names are constructed with <code>names_sep</code> and <code>names_prefix</code>, or the workhorse <code>names_glue</code></p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create tidy data</span></span>
<span><span class="va">production</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span></span>
<span>    product <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, </span>
<span>    country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AI"</span>, <span class="st">"EI"</span><span class="op">)</span>, </span>
<span>    year <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2014</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">product</span> <span class="op">==</span> <span class="st">"A"</span> <span class="op">&amp;</span> <span class="va">country</span> <span class="op">==</span> <span class="st">"AI"</span><span class="op">)</span> <span class="op">|</span> <span class="va">product</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>production <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">production</span></span>
<span><span class="co">#&gt; # A tibble: 45 × 4</span></span>
<span><span class="co">#&gt;    product country  year production</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 A       AI       2000      0.961</span></span>
<span><span class="co">#&gt;  2 A       AI       2001      0.608</span></span>
<span><span class="co">#&gt;  3 A       AI       2002      0.991</span></span>
<span><span class="co">#&gt;  4 A       AI       2003      0.309</span></span>
<span><span class="co">#&gt;  5 A       AI       2004     -0.197</span></span>
<span><span class="co">#&gt;  6 A       AI       2005      0.526</span></span>
<span><span class="co">#&gt;  7 A       AI       2006     -1.33 </span></span>
<span><span class="co">#&gt;  8 A       AI       2007     -0.838</span></span>
<span><span class="co">#&gt;  9 A       AI       2008     -1.66 </span></span>
<span><span class="co">#&gt; 10 A       AI       2009      1.11 </span></span>
<span><span class="co">#&gt; # ℹ 35 more rows</span></span>
<span></span>
<span><span class="co"># With names_sep and names_prefix</span></span>
<span><span class="va">production</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">product</span>, <span class="va">country</span><span class="op">)</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">production</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"prod."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 4</span></span>
<span><span class="co">#&gt;     year prod.A.AI prod.B.AI prod.B.EI</span></span>
<span><span class="co">#&gt;    &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  2000     0.961   -0.397     0.778 </span></span>
<span><span class="co">#&gt;  2  2001     0.608    1.77     -0.116 </span></span>
<span><span class="co">#&gt;  3  2002     0.991    0.222     1.34  </span></span>
<span><span class="co">#&gt;  4  2003     0.309   -1.16      0.292 </span></span>
<span><span class="co">#&gt;  5  2004    -0.197    0.135    -0.699 </span></span>
<span><span class="co">#&gt;  6  2005     0.526   -0.360    -0.126 </span></span>
<span><span class="co">#&gt;  7  2006    -1.33     0.217     1.48  </span></span>
<span><span class="co">#&gt;  8  2007    -0.838   -0.0331    0.0260</span></span>
<span><span class="co">#&gt;  9  2008    -1.66    -1.03      0.806 </span></span>
<span><span class="co">#&gt; 10  2009     1.11    -0.195     1.77  </span></span>
<span><span class="co">#&gt; 11  2010    -0.659   -1.38     -0.361 </span></span>
<span><span class="co">#&gt; 12  2011     1.08    -0.485    -0.591 </span></span>
<span><span class="co">#&gt; 13  2012     1.08    -0.680     0.648 </span></span>
<span><span class="co">#&gt; 14  2013    -0.674    0.535     0.202 </span></span>
<span><span class="co">#&gt; 15  2014    -0.214   -1.20     -1.09</span></span>
<span></span>
<span><span class="co"># With names_glue</span></span>
<span><span class="va">production</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">product</span>, <span class="va">country</span><span class="op">)</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">production</span>,</span>
<span>    names_glue <span class="op">=</span> <span class="st">"prod_{product}_{country}"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 4</span></span>
<span><span class="co">#&gt;     year prod_A_AI prod_B_AI prod_B_EI</span></span>
<span><span class="co">#&gt;    &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  2000     0.961   -0.397     0.778 </span></span>
<span><span class="co">#&gt;  2  2001     0.608    1.77     -0.116 </span></span>
<span><span class="co">#&gt;  3  2002     0.991    0.222     1.34  </span></span>
<span><span class="co">#&gt;  4  2003     0.309   -1.16      0.292 </span></span>
<span><span class="co">#&gt;  5  2004    -0.197    0.135    -0.699 </span></span>
<span><span class="co">#&gt;  6  2005     0.526   -0.360    -0.126 </span></span>
<span><span class="co">#&gt;  7  2006    -1.33     0.217     1.48  </span></span>
<span><span class="co">#&gt;  8  2007    -0.838   -0.0331    0.0260</span></span>
<span><span class="co">#&gt;  9  2008    -1.66    -1.03      0.806 </span></span>
<span><span class="co">#&gt; 10  2009     1.11    -0.195     1.77  </span></span>
<span><span class="co">#&gt; 11  2010    -0.659   -1.38     -0.361 </span></span>
<span><span class="co">#&gt; 12  2011     1.08    -0.485    -0.591 </span></span>
<span><span class="co">#&gt; 13  2012     1.08    -0.680     0.648 </span></span>
<span><span class="co">#&gt; 14  2013    -0.674    0.535     0.202 </span></span>
<span><span class="co">#&gt; 15  2014    -0.214   -1.20     -1.09</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-tidy-census" class="level3" data-number="10.2.4"><h3 data-number="10.2.4" class="anchored" data-anchor-id="sec-tidy-census">
<span class="header-section-number">10.2.4</span> Tidy census</h3>
<p>Data: <code>us_rent_income</code></p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">us_rent_income</span></span>
<span><span class="co">#&gt; # A tibble: 104 × 5</span></span>
<span><span class="co">#&gt;    GEOID NAME       variable estimate   moe</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 01    Alabama    income      24476   136</span></span>
<span><span class="co">#&gt;  2 01    Alabama    rent          747     3</span></span>
<span><span class="co">#&gt;  3 02    Alaska     income      32940   508</span></span>
<span><span class="co">#&gt;  4 02    Alaska     rent         1200    13</span></span>
<span><span class="co">#&gt;  5 04    Arizona    income      27517   148</span></span>
<span><span class="co">#&gt;  6 04    Arizona    rent          972     4</span></span>
<span><span class="co">#&gt;  7 05    Arkansas   income      23789   165</span></span>
<span><span class="co">#&gt;  8 05    Arkansas   rent          709     5</span></span>
<span><span class="co">#&gt;  9 06    California income      29454   109</span></span>
<span><span class="co">#&gt; 10 06    California rent         1358     3</span></span>
<span><span class="co">#&gt; # ℹ 94 more rows</span></span>
<span></span>
<span><span class="va">us_rent_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">variable</span>, </span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">moe</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 6</span></span>
<span><span class="co">#&gt;    GEOID NAME                 estimate_income estimate_rent moe_income moe_rent</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 01    Alabama                        24476           747        136        3</span></span>
<span><span class="co">#&gt;  2 02    Alaska                         32940          1200        508       13</span></span>
<span><span class="co">#&gt;  3 04    Arizona                        27517           972        148        4</span></span>
<span><span class="co">#&gt;  4 05    Arkansas                       23789           709        165        5</span></span>
<span><span class="co">#&gt;  5 06    California                     29454          1358        109        3</span></span>
<span><span class="co">#&gt;  6 08    Colorado                       32401          1125        109        5</span></span>
<span><span class="co">#&gt;  7 09    Connecticut                    35326          1123        195        5</span></span>
<span><span class="co">#&gt;  8 10    Delaware                       31560          1076        247       10</span></span>
<span><span class="co">#&gt;  9 11    District of Columbia           43198          1424        681       17</span></span>
<span><span class="co">#&gt; 10 12    Florida                        25952          1077         70        3</span></span>
<span><span class="co">#&gt; # ℹ 42 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See <a href="#sec-wide-spec" class="quarto-xref"><span>Section 10.4.2</span></a> for a different way to do this with a <code>spec</code>.</p>
</section><section id="sec-missing-vals" class="level3" data-number="10.2.5"><h3 data-number="10.2.5" class="anchored" data-anchor-id="sec-missing-vals">
<span class="header-section-number">10.2.5</span> Implicit missing values</h3>
<p>Data: Factor of weekdays</p>
<p>When you want to turn a column of factor data into column names. <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> defaults to generating columns from the data that exists, but you might want to include columns from all possible factor levels. Use <code>names_expand</code> to make implicit factor levels explicit.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data</span></span>
<span><span class="va">weekdays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mon"</span>, <span class="st">"Tue"</span>, <span class="st">"Wed"</span>, <span class="st">"Thu"</span>, <span class="st">"Fri"</span>, <span class="st">"Sat"</span>, <span class="st">"Sun"</span><span class="op">)</span></span>
<span><span class="va">daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tue"</span>, <span class="st">"Thu"</span>, <span class="st">"Fri"</span>, <span class="st">"Mon"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">weekdays</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">daily</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span><span class="co">#&gt;   day   value</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Tue       2</span></span>
<span><span class="co">#&gt; 2 Thu       3</span></span>
<span><span class="co">#&gt; 3 Fri       1</span></span>
<span><span class="co">#&gt; 4 Mon       5</span></span>
<span></span>
<span><span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">day</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>, </span>
<span>    names_expand <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 7</span></span>
<span><span class="co">#&gt;     Mon   Tue   Wed   Thu   Fri   Sat   Sun</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     5     2    NA     3     1    NA    NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Data: Factor and year data</p>
<p>If multiple <code>names_from</code> columns are provided, <code>names_expand</code> will generate a Cartesian product of all possible combinations of the names_from values.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data</span></span>
<span><span class="va">percentages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">2019</span>, <span class="fl">2020</span>, <span class="fl">2020</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">40</span>, <span class="fl">60</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">percentages</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;    year type  percentage</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2018 A            100</span></span>
<span><span class="co">#&gt; 2  2019 B            100</span></span>
<span><span class="co">#&gt; 3  2020 A             40</span></span>
<span><span class="co">#&gt; 4  2020 B             60</span></span>
<span></span>
<span><span class="va">percentages</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">year</span><span class="op">)</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">percentage</span>,</span>
<span>    names_expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 6</span></span>
<span><span class="co">#&gt;   A_2018 A_2019 A_2020 B_2018 B_2019 B_2020</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1    100      0     40      0    100     60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Data: Missing factor levels in <code>id_cols</code></p>
<p>Missing rows in factor instead of missing columns as above. Need to use <code>id_expand = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">daily</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">daily</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   day   value type </span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt;</span></span>
<span><span class="co">#&gt; 1 Tue       2 A    </span></span>
<span><span class="co">#&gt; 2 Thu       3 B    </span></span>
<span><span class="co">#&gt; 3 Fri       1 B    </span></span>
<span><span class="co">#&gt; 4 Mon       5 A</span></span>
<span></span>
<span><span class="va">daily</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">type</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>,</span>
<span>    values_fill <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    id_expand <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 3</span></span>
<span><span class="co">#&gt;   day       A     B</span></span>
<span><span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Mon       5     0</span></span>
<span><span class="co">#&gt; 2 Tue       2     0</span></span>
<span><span class="co">#&gt; 3 Wed       0     0</span></span>
<span><span class="co">#&gt; 4 Thu       0     3</span></span>
<span><span class="co">#&gt; 5 Fri       0     1</span></span>
<span><span class="co">#&gt; 6 Sat       0     0</span></span>
<span><span class="co">#&gt; 7 Sun       0     0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-unused-cols" class="level3" data-number="10.2.6"><h3 data-number="10.2.6" class="anchored" data-anchor-id="sec-unused-cols">
<span class="header-section-number">10.2.6</span> Unused columns</h3>
<p>Issue of retaining some data in a column that is not related to the pivoting process. Use of <code>unused_fn</code> to apply a function to unused columns instead of dropping them. You can retain the information by creating a list column.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data</span></span>
<span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  county <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wake"</span>, <span class="st">"Wake"</span>, <span class="st">"Wake"</span>, <span class="st">"Guilford"</span>, <span class="st">"Guilford"</span><span class="op">)</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-03"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  system <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.2</span>, <span class="fl">4</span>, <span class="fl">5.5</span>, <span class="fl">2</span>, <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">updates</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 4</span></span>
<span><span class="co">#&gt;   county   date       system value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;date&gt;     &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Wake     2023-01-01 A        3.2</span></span>
<span><span class="co">#&gt; 2 Wake     2023-01-02 B        4  </span></span>
<span><span class="co">#&gt; 3 Wake     2023-01-03 C        5.5</span></span>
<span><span class="co">#&gt; 4 Guilford 2023-01-03 A        2  </span></span>
<span><span class="co">#&gt; 5 Guilford 2023-01-04 C        1.2</span></span>
<span></span>
<span><span class="co"># max</span></span>
<span><span class="va">updates</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">county</span>, </span>
<span>    names_from <span class="op">=</span> <span class="va">system</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>,</span>
<span>    unused_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   county       A     B     C date      </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;    </span></span>
<span><span class="co">#&gt; 1 Wake       3.2     4   5.5 2023-01-03</span></span>
<span><span class="co">#&gt; 2 Guilford   2      NA   1.2 2023-01-04</span></span>
<span></span>
<span><span class="co"># list column</span></span>
<span><span class="va">updates</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">county</span>, </span>
<span>    names_from <span class="op">=</span> <span class="va">system</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>,</span>
<span>    unused_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">list</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   county       A     B     C date      </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    </span></span>
<span><span class="co">#&gt; 1 Wake       3.2     4   5.5 &lt;date [3]&gt;</span></span>
<span><span class="co">#&gt; 2 Guilford   2      NA   1.2 &lt;date [2]&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-contacts" class="level3" data-number="10.2.7"><h3 data-number="10.2.7" class="anchored" data-anchor-id="sec-contacts">
<span class="header-section-number">10.2.7</span> Contact list</h3>
<p>Contact list with variable number of fields per contact. Can use <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> to create unique id based on first value for each person (<code>name</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data</span></span>
<span><span class="va">contacts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">field</span>, <span class="op">~</span><span class="va">value</span>,</span>
<span>  <span class="st">"name"</span>, <span class="st">"Jiena McLellan"</span>,</span>
<span>  <span class="st">"company"</span>, <span class="st">"Toyota"</span>, </span>
<span>  <span class="st">"name"</span>, <span class="st">"John Smith"</span>, </span>
<span>  <span class="st">"company"</span>, <span class="st">"google"</span>, </span>
<span>  <span class="st">"email"</span>, <span class="st">"john@google.com"</span>,</span>
<span>  <span class="st">"name"</span>, <span class="st">"Huxley Ratcliffe"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Create unique id</span></span>
<span><span class="va">contacts</span> <span class="op">&lt;-</span> <span class="va">contacts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>person_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">field</span> <span class="op">==</span> <span class="st">"name"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contacts</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   field   value            person_id</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 name    Jiena McLellan           1</span></span>
<span><span class="co">#&gt; 2 company Toyota                   1</span></span>
<span><span class="co">#&gt; 3 name    John Smith               2</span></span>
<span><span class="co">#&gt; 4 company google                   2</span></span>
<span><span class="co">#&gt; 5 email   john@google.com          2</span></span>
<span><span class="co">#&gt; 6 name    Huxley Ratcliffe         3</span></span>
<span></span>
<span><span class="va">contacts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">field</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   person_id name             company email          </span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1         1 Jiena McLellan   Toyota  &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 2         2 John Smith       google  john@google.com</span></span>
<span><span class="co">#&gt; 3         3 Huxley Ratcliffe &lt;NA&gt;    &lt;NA&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-longer-wider" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="sec-longer-wider">
<span class="header-section-number">10.3</span> Longer, then wider</h2>
<section id="sec-worldbank" class="level3" data-number="10.3.1"><h3 data-number="10.3.1" class="anchored" data-anchor-id="sec-worldbank">
<span class="header-section-number">10.3.1</span> World bank</h3>
<p>Data: <code>world_bank_pop</code></p>
<p>Problems:</p>
<ol type="1">
<li>Year variables are column names: <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>.</li>
<li>
<code>indicator</code> column contains multiple variables.</li>
<li>This creates variable column with two variables that should be widened: <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>
</li>
<li>Make new column names lowercase: <code><a href="https://dplyr.tidyverse.org/reference/rename.html">dplyr::rename_with()</a></code>
</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">world_bank_pop</span></span>
<span><span class="co">#&gt; # A tibble: 1,064 × 20</span></span>
<span><span class="co">#&gt;    country indicator      `2000`  `2001`  `2002`  `2003`  `2004`  `2005`  `2006`</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ABW     SP.URB.TOTL    4.16e4 4.20e+4 4.22e+4 4.23e+4 4.23e+4 4.24e+4 4.26e+4</span></span>
<span><span class="co">#&gt;  2 ABW     SP.URB.GROW    1.66e0 9.56e-1 4.01e-1 1.97e-1 9.46e-2 1.94e-1 3.67e-1</span></span>
<span><span class="co">#&gt;  3 ABW     SP.POP.TOTL    8.91e4 9.07e+4 9.18e+4 9.27e+4 9.35e+4 9.45e+4 9.56e+4</span></span>
<span><span class="co">#&gt;  4 ABW     SP.POP.GROW    2.54e0 1.77e+0 1.19e+0 9.97e-1 9.01e-1 1.00e+0 1.18e+0</span></span>
<span><span class="co">#&gt;  5 AFE     SP.URB.TOTL    1.16e8 1.20e+8 1.24e+8 1.29e+8 1.34e+8 1.39e+8 1.44e+8</span></span>
<span><span class="co">#&gt;  6 AFE     SP.URB.GROW    3.60e0 3.66e+0 3.72e+0 3.71e+0 3.74e+0 3.81e+0 3.81e+0</span></span>
<span><span class="co">#&gt;  7 AFE     SP.POP.TOTL    4.02e8 4.12e+8 4.23e+8 4.34e+8 4.45e+8 4.57e+8 4.70e+8</span></span>
<span><span class="co">#&gt;  8 AFE     SP.POP.GROW    2.58e0 2.59e+0 2.61e+0 2.62e+0 2.64e+0 2.67e+0 2.70e+0</span></span>
<span><span class="co">#&gt;  9 AFG     SP.URB.TOTL    4.31e6 4.36e+6 4.67e+6 5.06e+6 5.30e+6 5.54e+6 5.83e+6</span></span>
<span><span class="co">#&gt; 10 AFG     SP.URB.GROW    1.86e0 1.15e+0 6.86e+0 7.95e+0 4.59e+0 4.47e+0 5.03e+0</span></span>
<span><span class="co">#&gt; # ℹ 1,054 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: `2007` &lt;dbl&gt;, `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</span></span>
<span></span>
<span><span class="co"># 1. Pivot longer</span></span>
<span><span class="va">world_bank_pop</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="va">`2000`</span><span class="op">:</span><span class="va">`2017`</span>, </span>
<span>    names_to <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="co"># 2. separate indicator column</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">indicator</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"area"</span>, <span class="st">"variable"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="co"># 3. pivot variable column wider</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">variable</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">value</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="co"># 4. Make new column names lowercase</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="va">tolower</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9,576 × 5</span></span>
<span><span class="co">#&gt;    country area  year   totl   grow</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ABW     URB   2000  41625 1.66  </span></span>
<span><span class="co">#&gt;  2 ABW     URB   2001  42025 0.956 </span></span>
<span><span class="co">#&gt;  3 ABW     URB   2002  42194 0.401 </span></span>
<span><span class="co">#&gt;  4 ABW     URB   2003  42277 0.197 </span></span>
<span><span class="co">#&gt;  5 ABW     URB   2004  42317 0.0946</span></span>
<span><span class="co">#&gt;  6 ABW     URB   2005  42399 0.194 </span></span>
<span><span class="co">#&gt;  7 ABW     URB   2006  42555 0.367 </span></span>
<span><span class="co">#&gt;  8 ABW     URB   2007  42729 0.408 </span></span>
<span><span class="co">#&gt;  9 ABW     URB   2008  42906 0.413 </span></span>
<span><span class="co">#&gt; 10 ABW     URB   2009  43079 0.402 </span></span>
<span><span class="co">#&gt; # ℹ 9,566 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-multi-choice" class="level3" data-number="10.3.2"><h3 data-number="10.3.2" class="anchored" data-anchor-id="sec-multi-choice">
<span class="header-section-number">10.3.2</span> Multi-choice</h3>
<p>Going from data that has choice number as columns to whether an individual selected that choice or not.</p>
<ol type="1">
<li>Make data longer, while eliminating <code>NA</code>s to only have choices that were made.</li>
<li>Add logical column with <code>TRUE</code>s.</li>
<li>Pivot data wider and fill in missing observations with <code>FALSE</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Data</span></span>
<span><span class="va">multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>, <span class="op">~</span><span class="va">choice1</span>, <span class="op">~</span><span class="va">choice2</span>, <span class="op">~</span><span class="va">choice3</span>,</span>
<span>  <span class="fl">1</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>,</span>
<span>  <span class="fl">2</span>, <span class="st">"C"</span>, <span class="st">"B"</span>,  <span class="cn">NA</span>,</span>
<span>  <span class="fl">3</span>, <span class="st">"D"</span>,  <span class="cn">NA</span>,  <span class="cn">NA</span>,</span>
<span>  <span class="fl">4</span>, <span class="st">"B"</span>, <span class="st">"D"</span>,  <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="va">multi</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 4</span></span>
<span><span class="co">#&gt;      id choice1 choice2 choice3</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1     1 A       B       C      </span></span>
<span><span class="co">#&gt; 2     2 C       B       &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; 3     3 D       &lt;NA&gt;    &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; 4     4 B       D       &lt;NA&gt;</span></span>
<span></span>
<span><span class="co"># 1. Pivot longer</span></span>
<span><span class="va">multi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">!</span><span class="va">id</span>, </span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="co"># 2. Add col whether choice was made</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>checked <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="co"># 3. Pivot wider</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">id</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">value</span>, </span>
<span>    values_from <span class="op">=</span> <span class="va">checked</span>, </span>
<span>    values_fill <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 5</span></span>
<span><span class="co">#&gt;      id A     B     C     D    </span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;</span></span>
<span><span class="co">#&gt; 1     1 TRUE  TRUE  TRUE  FALSE</span></span>
<span><span class="co">#&gt; 2     2 FALSE TRUE  TRUE  FALSE</span></span>
<span><span class="co">#&gt; 3     3 FALSE FALSE FALSE TRUE </span></span>
<span><span class="co">#&gt; 4     4 FALSE TRUE  FALSE TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-specs" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="sec-specs">
<span class="header-section-number">10.4</span> Manual specs</h2>
<p>To gain more control over pivoting, you can instead create a “spec” data frame that describes exactly how data stored in the column names becomes variables (and vice versa). This section focuses on the use of <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">build_longer_spec()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">pivot_longer_spec()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">build_wider_spec()</a></code>, and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">pivot_wider_spec()</a></code>.</p>
<p>A <code>spec</code> data frame created by <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">build_longer_spec()</a></code> or <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">build_wider_spec()</a></code> with special columns called <code>.name</code> for the name of the columns and <code>.value</code> for the name of the column that the values in the cells will go into. There is also one column in spec for each column present in the long format of the data that is not present in the wide format of the data. This corresponds to the <code>names_to</code> argument in <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> and the <code>names_from</code> argument in <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">relig_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">build_longer_spec</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">!</span><span class="va">religion</span>, </span>
<span>    names_to <span class="op">=</span> <span class="st">"income"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"count"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span><span class="co">#&gt;    .name              .value income            </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;             </span></span>
<span><span class="co">#&gt;  1 &lt;$10k              count  &lt;$10k             </span></span>
<span><span class="co">#&gt;  2 $10-20k            count  $10-20k           </span></span>
<span><span class="co">#&gt;  3 $20-30k            count  $20-30k           </span></span>
<span><span class="co">#&gt;  4 $30-40k            count  $30-40k           </span></span>
<span><span class="co">#&gt;  5 $40-50k            count  $40-50k           </span></span>
<span><span class="co">#&gt;  6 $50-75k            count  $50-75k           </span></span>
<span><span class="co">#&gt;  7 $75-100k           count  $75-100k          </span></span>
<span><span class="co">#&gt;  8 $100-150k          count  $100-150k         </span></span>
<span><span class="co">#&gt;  9 &gt;150k              count  &gt;150k             </span></span>
<span><span class="co">#&gt; 10 Don't know/refused count  Don't know/refused</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-long-spec" class="level3" data-number="10.4.1"><h3 data-number="10.4.1" class="anchored" data-anchor-id="sec-long-spec">
<span class="header-section-number">10.4.1</span> Longer</h3>
<p>Data: <code>relig_income</code></p>
<p>With a spec the process for pivoting is two steps. Creating a spec and then pivoting the spec. This does the same as <a href="#sec-string-data" class="quarto-xref"><span>Section 10.1.1</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Build spec</span></span>
<span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">relig_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">build_longer_spec</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">!</span><span class="va">religion</span>, </span>
<span>    names_to <span class="op">=</span> <span class="st">"income"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"count"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">spec</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span><span class="co">#&gt;    .name              .value income            </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;             </span></span>
<span><span class="co">#&gt;  1 &lt;$10k              count  &lt;$10k             </span></span>
<span><span class="co">#&gt;  2 $10-20k            count  $10-20k           </span></span>
<span><span class="co">#&gt;  3 $20-30k            count  $20-30k           </span></span>
<span><span class="co">#&gt;  4 $30-40k            count  $30-40k           </span></span>
<span><span class="co">#&gt;  5 $40-50k            count  $40-50k           </span></span>
<span><span class="co">#&gt;  6 $50-75k            count  $50-75k           </span></span>
<span><span class="co">#&gt;  7 $75-100k           count  $75-100k          </span></span>
<span><span class="co">#&gt;  8 $100-150k          count  $100-150k         </span></span>
<span><span class="co">#&gt;  9 &gt;150k              count  &gt;150k             </span></span>
<span><span class="co">#&gt; 10 Don't know/refused count  Don't know/refused</span></span>
<span></span>
<span><span class="co"># Pivot with spec</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">pivot_longer_spec</a></span><span class="op">(</span><span class="va">relig_income</span>, <span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 180 × 3</span></span>
<span><span class="co">#&gt;    religion income             count</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Agnostic &lt;$10k                 27</span></span>
<span><span class="co">#&gt;  2 Agnostic $10-20k               34</span></span>
<span><span class="co">#&gt;  3 Agnostic $20-30k               60</span></span>
<span><span class="co">#&gt;  4 Agnostic $30-40k               81</span></span>
<span><span class="co">#&gt;  5 Agnostic $40-50k               76</span></span>
<span><span class="co">#&gt;  6 Agnostic $50-75k              137</span></span>
<span><span class="co">#&gt;  7 Agnostic $75-100k             122</span></span>
<span><span class="co">#&gt;  8 Agnostic $100-150k            109</span></span>
<span><span class="co">#&gt;  9 Agnostic &gt;150k                 84</span></span>
<span><span class="co">#&gt; 10 Agnostic Don't know/refused    96</span></span>
<span><span class="co">#&gt; # ℹ 170 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-wide-spec" class="level3" data-number="10.4.2"><h3 data-number="10.4.2" class="anchored" data-anchor-id="sec-wide-spec">
<span class="header-section-number">10.4.2</span> Wider</h3>
<p>Data: <code>us_rent_income</code></p>
<p>Ability to improve the widening of the data from <a href="#sec-tidy-census" class="quarto-xref"><span>Section 10.2.4</span></a> through the use of a <code>spec</code>. Change the names of the columns from the default of <code>estimate_income</code>, <code>estimate_rent</code>, <code>moe_income</code>, and <code>moe_rent</code> to <code>income</code>, <code>rent</code>, <code>income_moe</code>, and <code>rent_moe</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Default spec</span></span>
<span><span class="va">spec1</span> <span class="op">&lt;-</span> <span class="va">us_rent_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">build_wider_spec</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">variable</span>, </span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">moe</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">spec1</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   .name           .value   variable</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 estimate_income estimate income  </span></span>
<span><span class="co">#&gt; 2 estimate_rent   estimate rent    </span></span>
<span><span class="co">#&gt; 3 moe_income      moe      income  </span></span>
<span><span class="co">#&gt; 4 moe_rent        moe      rent</span></span>
<span></span>
<span><span class="co"># Modify spec with mutate on .names</span></span>
<span><span class="va">spec2</span> <span class="op">&lt;-</span> <span class="va">spec1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">variable</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">.value</span> <span class="op">==</span> <span class="st">"moe"</span>, <span class="st">"_moe"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">spec2</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   .name      .value   variable</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 income     estimate income  </span></span>
<span><span class="co">#&gt; 2 rent       estimate rent    </span></span>
<span><span class="co">#&gt; 3 income_moe moe      income  </span></span>
<span><span class="co">#&gt; 4 rent_moe   moe      rent</span></span>
<span></span>
<span><span class="co"># Pivot with spec</span></span>
<span><span class="va">us_rent_income</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">pivot_wider_spec</a></span><span class="op">(</span><span class="va">spec2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 6</span></span>
<span><span class="co">#&gt;    GEOID NAME                 income  rent income_moe rent_moe</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 01    Alabama               24476   747        136        3</span></span>
<span><span class="co">#&gt;  2 02    Alaska                32940  1200        508       13</span></span>
<span><span class="co">#&gt;  3 04    Arizona               27517   972        148        4</span></span>
<span><span class="co">#&gt;  4 05    Arkansas              23789   709        165        5</span></span>
<span><span class="co">#&gt;  5 06    California            29454  1358        109        3</span></span>
<span><span class="co">#&gt;  6 08    Colorado              32401  1125        109        5</span></span>
<span><span class="co">#&gt;  7 09    Connecticut           35326  1123        195        5</span></span>
<span><span class="co">#&gt;  8 10    Delaware              31560  1076        247       10</span></span>
<span><span class="co">#&gt;  9 11    District of Columbia  43198  1424        681       17</span></span>
<span><span class="co">#&gt; 10 12    Florida               25952  1077         70        3</span></span>
<span><span class="co">#&gt; # ℹ 42 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-by-hand" class="level3" data-number="10.4.3"><h3 data-number="10.4.3" class="anchored" data-anchor-id="sec-by-hand">
<span class="header-section-number">10.4.3</span> By hand</h3>
<p>Data: <code>construction</code></p>
<p>The column names in the data are two different kinds of variables: <code>units</code> and <code>region</code>. This can be described by creating a <code>spec</code> by hand.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">.name</span>,            <span class="op">~</span><span class="va">.value</span>, <span class="op">~</span><span class="va">units</span>,  <span class="op">~</span><span class="va">region</span>,     </span>
<span>  <span class="st">"1 unit"</span>,          <span class="st">"n"</span>,     <span class="st">"1"</span>,     <span class="cn">NA</span>,          </span>
<span>  <span class="st">"2 to 4 units"</span>,    <span class="st">"n"</span>,     <span class="st">"2-4"</span>,   <span class="cn">NA</span>,          </span>
<span>  <span class="st">"5 units or more"</span>, <span class="st">"n"</span>,     <span class="st">"5+"</span>,    <span class="cn">NA</span>,          </span>
<span>  <span class="st">"Northeast"</span>,       <span class="st">"n"</span>,     <span class="cn">NA</span>,      <span class="st">"Northeast"</span>, </span>
<span>  <span class="st">"Midwest"</span>,         <span class="st">"n"</span>,     <span class="cn">NA</span>,      <span class="st">"Midwest"</span>,   </span>
<span>  <span class="st">"South"</span>,           <span class="st">"n"</span>,     <span class="cn">NA</span>,      <span class="st">"South"</span>,     </span>
<span>  <span class="st">"West"</span>,            <span class="st">"n"</span>,     <span class="cn">NA</span>,      <span class="st">"West"</span>,      </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">construction</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">pivot_longer_spec</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 63 × 5</span></span>
<span><span class="co">#&gt;     Year Month    units region        n</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  2018 January  1     &lt;NA&gt;        859</span></span>
<span><span class="co">#&gt;  2  2018 January  2-4   &lt;NA&gt;         NA</span></span>
<span><span class="co">#&gt;  3  2018 January  5+    &lt;NA&gt;        348</span></span>
<span><span class="co">#&gt;  4  2018 January  &lt;NA&gt;  Northeast   114</span></span>
<span><span class="co">#&gt;  5  2018 January  &lt;NA&gt;  Midwest     169</span></span>
<span><span class="co">#&gt;  6  2018 January  &lt;NA&gt;  South       596</span></span>
<span><span class="co">#&gt;  7  2018 January  &lt;NA&gt;  West        339</span></span>
<span><span class="co">#&gt;  8  2018 February 1     &lt;NA&gt;        882</span></span>
<span><span class="co">#&gt;  9  2018 February 2-4   &lt;NA&gt;         NA</span></span>
<span><span class="co">#&gt; 10  2018 February 5+    &lt;NA&gt;        400</span></span>
<span><span class="co">#&gt; # ℹ 53 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since there is no overlap between the <code>units</code> and <code>region</code> data, it would actually be better to place them in two separate tables.</p>
</section><section id="sec-theory" class="level3" data-number="10.4.4"><h3 data-number="10.4.4" class="anchored" data-anchor-id="sec-theory">
<span class="header-section-number">10.4.4</span> Theory</h3>
<p>The same <code>spec</code> is used for <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>. You can see this through the symmetry of the two functions.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">construction</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">pivot_longer_spec</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">pivot_wider_spec</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 9</span></span>
<span><span class="co">#&gt;    Year Month  `1 unit` `2 to 4 units` `5 units or more` Northeast Midwest South</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2018 Janua…      859             NA               348       114     169   596</span></span>
<span><span class="co">#&gt; 2  2018 Febru…      882             NA               400       138     160   655</span></span>
<span><span class="co">#&gt; 3  2018 March       862             NA               356       150     154   595</span></span>
<span><span class="co">#&gt; 4  2018 April       797             NA               447       144     196   613</span></span>
<span><span class="co">#&gt; 5  2018 May         875             NA               364        90     169   673</span></span>
<span><span class="co">#&gt; 6  2018 June        867             NA               342        76     170   610</span></span>
<span><span class="co">#&gt; 7  2018 July        829             NA               360       108     183   594</span></span>
<span><span class="co">#&gt; 8  2018 August      939             NA               286        90     205   649</span></span>
<span><span class="co">#&gt; 9  2018 Septe…      835             NA               304       117     175   560</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: West &lt;dbl&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-tidy-data.html" class="pagination-link  aria-label=" data="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tidy data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01-tidyr-rectangling.html" class="pagination-link" aria-label="<span class='chapter-number'>11</span>&nbsp; <span class='chapter-title'>tidyr: Rectandling</span>">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">tidyr: Rectandling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jessesadler/notes-tidyverse/edit/main/01-tidyr-pivoting.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jessesadler/notes-tidyverse/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>